{% extends 'Template/StandardTemplate.html.twig' %}

{% if subride %}
    {% set title = 'Mini-Mass editieren' %}
{% else %}
    {% set title = 'Mini-Mass hinzufügen' %}
{% endif %}

{% block title %}{{ title }}{% endblock %}

{% import '_macros/breadcrumb.html.twig' as bc %}

{% block breadcrumbs %}
    {{ bc.render(
        [
            { label: 'Städteliste', url: path('caldera_criticalmass_city_list') },
            { label: ride.city.city, url: object_path(ride.city) },
            { label: ride.title, url: object_path(ride) },
            { label: 'Mini-Mass editieren' },
            { label: 'Mini-Mass hinzufügen' },
        ],
        {
            homeLabel: 'Critical Mass',
            homeUrl: path('caldera_criticalmass_frontpage')
        }
    ) }}
{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h1>
                    {{ title }}
                </h1>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <p>
                    Eine Mini Mass ist eine gemeinsame Radtour zur eigentlichen Critical Mass. Das Prinzip der Mini Mass
                    stammt aus größeren Städten, in denen sich Radfahrer der einzelnen Stadtteile zu einer gemeinsamen
                    Radtour verabredet haben, um nicht alleine zur „großen Masse" fahren zu müssen.
                </p>
            </div>
        </div>

        {{ include('Flash/_flash.html.twig') }}

        {{ form_start(form) }}
        <div class="row">
            <div class="col-12">
                <div id="map"
                     class="map"
                     data-controller="map--map"
                     style="height: 250px;"
                     data-map--map-center-latitude-value="{{ ride.latitude }}"
                     data-map--map-center-longitude-value="{{ ride.longitude }}"
                     data-map--map-zoom-value="10"
                     data-map--map-marker-draggable-value="true"
                     data-map--map-marker-type-value="subride"
                     data-map--map-marker-latitude-target-value="subride_latitude"
                     data-map--map-marker-longitude-target-value="subride_longitude">
                </div>
            </div>
        </div>

        <div class="row margin-top-medium">
            <div class="col-md-6">
                <div class="row">
                    <div class="col-12">
                        <h3>
                            Daten der Mini-Mass
                        </h3>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="mb-3">
                            <label class="form-label" for="title">Titel:</label>
                            {{ form_widget(form.title, { 'attr' : { 'class': 'form-control' ~ (form_errors(form.title) ? ' is-invalid' : '') } }) }}
                            {% if form_errors(form.title) %}
                                <div class="invalid-feedback d-block">{{ form_errors(form.title) }}</div>
                            {% endif %}
                            <div class="form-text">
                                Gib deiner Mini-Mass einen Namen. Er muss noch nicht einmal aussagekräftig
                                sein — Hauptsache man weiß, worum es geht.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="mb-3">
                            <label class="form-label" for="description">Beschreibung:</label>
                            {{ form_widget(form.description, { 'attr' : { 'class': 'form-control' } }) }}
                            <div class="form-text">
                                Hier ist Platz für eine grobe Beschreibung der Mini-Mass. Lege hier zum
                                Beispiel eine ungefähre Route fest.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="mb-3">
                            <label class="form-label" for="description">Treffpunkt:</label>
                            {{ form_widget(form.location, { 'attr' : { 'class': 'form-control' ~ (form_errors(form.location) ? ' is-invalid' : '') } }) }}
                            {% if form_errors(form.location) %}
                                <div class="invalid-feedback d-block">{{ form_errors(form.location) }}</div>
                            {% endif %}
                            <div class="form-text">
                                Wo trefft ihr euch? Vergiss nicht, den Treffpunkt oben auf der Karte
                                zu markieren.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="row">
                    <div class="col-12">
                        <h3>
                            Datum und Uhrzeit
                        </h3>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="mb-3">
                            <label class="form-label" for="description">Datum:</label>
                            <div class="form-control-plaintext">{{ ride.getDateTime().format('d. F Y') }}</div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="mb-3">
                            <label class="form-label" for="description">Uhrzeit:</label>
                            {{ form_widget(form.time, { 'attr' : { 'class': 'form-control' } }) }}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-12">
                <div class="d-flex justify-content-end gap-2">
                    <a href="{{ object_path(ride) }}" class="btn btn-secondary">
                        Abbrechen
                    </a>
                    <button type="submit" class="btn btn-success">
                        Speichern
                    </button>
                </div>
            </div>
        </div>

        {{ form_widget(form.latitude) }}
        {{ form_widget(form.longitude) }}
        {{ form_widget(form._token) }}

        {{ form_end(form) }}
    </div>
{% endblock %}
